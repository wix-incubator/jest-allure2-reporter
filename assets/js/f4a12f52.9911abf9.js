"use strict";(self.webpackChunk_wix_website_jest_allure2_reporter=self.webpackChunk_wix_website_jest_allure2_reporter||[]).push([[514],{6719:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"docs/config/grouping/by-story","title":"By Story","description":"Behavior-driven way to group test results.","source":"@site/../docs/docs/config/01-grouping/02-by-story.mdx","sourceDirName":"docs/config/01-grouping","slug":"/docs/config/grouping/by-story","permalink":"/jest-allure2-reporter/docs/config/grouping/by-story","draft":false,"unlisted":false,"editUrl":"https://github.com/wix-incubator/jest-allure2-reporter/tree/master/docs/../docs/docs/config/01-grouping/02-by-story.mdx","tags":[],"version":"current","lastUpdatedBy":"Yaroslav Serhieiev","lastUpdatedAt":1730882347000,"sidebarPosition":2,"frontMatter":{"description":"Behavior-driven way to group test results."},"sidebar":"docsSidebar","previous":{"title":"By Suite","permalink":"/jest-allure2-reporter/docs/config/grouping/by-suite"},"next":{"title":"By Package","permalink":"/jest-allure2-reporter/docs/config/grouping/by-package"}}');var s=t(4848),o=t(8453),a=t(9489),i=t(7227);const l={description:"Behavior-driven way to group test results."},c="By Story",u={},d=[{value:"Using annotations",id:"using-annotations",level:2},{value:"Using configuration",id:"using-configuration",level:2},{value:"Many-to-many mapping",id:"many-to-many-mapping",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{ArticleHeader:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ArticleHeader",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"by-story",children:"By Story"})}),"\n",(0,s.jsxs)(n.p,{children:["This grouping option is a concept that comes from the ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Behavior-driven_development",children:"Behavior-Driven Development"})," (BDD) methodology.\nUnlike the ",(0,s.jsx)(n.a,{href:"/jest-allure2-reporter/docs/config/grouping/by-suite",children:"suite-based grouping"}),", which is based on the technical structure of your test suite, the story-based grouping\nhelps you to focus on the business value of your tests and view them from the end-user perspective."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Grouping by story",src:t(9810).A+"",width:"2048",height:"1200"})}),"\n",(0,s.jsxs)(n.p,{children:["The story-oriented hierarchy has 4 mandatory levels: ",(0,s.jsx)(n.strong,{children:"epic"}),", ",(0,s.jsx)(n.strong,{children:"feature"}),", ",(0,s.jsx)(n.strong,{children:"story"})," and ",(0,s.jsx)(n.strong,{children:"test case"}),"."]}),"\n",(0,s.jsx)(n.admonition,{title:"Glossary",type:"info",children:(0,s.jsxs)("dl",{children:[(0,s.jsx)("dt",{children:(0,s.jsx)("strong",{children:"Epic"})}),(0,s.jsx)("dd",{children:"High-level business goal"}),(0,s.jsx)("dt",{children:(0,s.jsx)("strong",{children:"Feature"})}),(0,s.jsx)("dd",{children:"Functionality that delivers business value"}),(0,s.jsx)("dt",{children:(0,s.jsx)("strong",{children:"Story"})}),(0,s.jsx)("dd",{children:"User story that describes a feature from the end-user perspective"}),(0,s.jsx)("dt",{children:(0,s.jsx)("strong",{children:"Test Case"})}),(0,s.jsxs)("dd",{children:["Atomic, lowest-level unit. In Jest, it is a single ",(0,s.jsx)("code",{children:"it"})," or ",(0,s.jsx)("code",{children:"test"})," function."]})]})}),"\n",(0,s.jsx)(n.p,{children:"Before you start using this grouping option, you need to decide how exactly you want to implement it:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["via ",(0,s.jsx)(n.a,{href:"#annotations-api",children:"annotations"})," \u2013 a more granular approach, which allows you to control the grouping on a per-test basis;"]}),"\n",(0,s.jsxs)(n.li,{children:["via ",(0,s.jsx)(n.a,{href:"#configuration-api",children:"configuration"})," \u2013 a quick option to enable it all at once, based on general rules;"]}),"\n",(0,s.jsxs)(n.li,{children:["via ",(0,s.jsx)(n.em,{children:"mixing these approaches"})," \u2013 a compromise between the two, where the configuration serves as a fallback for missing annotations."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"using-annotations",children:"Using annotations"}),"\n",(0,s.jsx)(r,{}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"/jest-allure2-reporter/docs/features/labels",children:"annotation-based approach"})," gives you a fine-grained control over the names of your epic, feature and story labels, but it requires you to add annotations to ",(0,s.jsx)(n.em,{children:"every and each test case"})," (sic!) which can be tedious."]}),"\n",(0,s.jsxs)(n.p,{children:["Let's take the same project as in the previous article, where there are two parts: client and server.\nBoth them deal with the same functionality \u2013 authentication and restoring forgotten passwords.\nHence, it would make sense to group both client and server tests under the same epic named ",(0,s.jsx)(n.strong,{children:"Authentication"}),", and continue grouping them by features and stories regardless of the application layer."]}),"\n",(0,s.jsxs)(a.A,{groupId:"configTab",children:[(0,s.jsx)(i.A,{value:"docblock",label:"Docblocks",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="login.test.js"',children:"/**\n * @epic Authentication\n * @feature Login screen\n */\ndescribe('Login controller', () => {\n  it('should validate e-mail', () => {\n    /** @story Validation */\n    // ...\n  });\n\n  it('should return 401 if user is not found', () => {\n    /** @story Validation */\n    // ...\n  });\n});\n"})})}),(0,s.jsx)(i.A,{value:"dsl",label:"DSL",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="login.test.js"',children:"import { $Epic, $Feature, $Story } from 'jest-allure2-reporter/api';\n\n$Epic('Authentication');\n$Feature('Login screen');\ndescribe('Login controller', () => {\n  $Story('Validation');\n  it('should validate e-mail', () => {\n    // ...\n  });\n\n  $Story('Validation');\n  it('should return 401 if user is not found', () => {\n    // ...\n  });\n});\n"})})}),(0,s.jsx)(i.A,{value:"demo",label:"Preview",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"\u2514\u2500 Authentication\n   \u251c\u2500 Login screen\n   \u2502  \u251c\u2500 General\n   \u2502  \u2502  \u251c\u2500 should display login form on client\n   \u2502  \u251c\u2500 Validation\n   \u2502  \u2502  \u251c\u2500 should validate e-mail on client\n   \u2502  \u2502  \u251c\u2500 should validate e-mail on server\n   \u2502  \u2502  \u251c\u2500 should return 401 if user is not found\n   \u2502  \u2502  \u2514\u2500 should return 401 if password is incorrect\n   \u2514\u2500 Forgot password screen\n      \u2514\u2500 Validation\n         \u251c\u2500 should validate e-mail on client\n         \u251c\u2500 should validate e-mail on server\n         \u251c\u2500 should return 401 if user is not found\n         \u2514\u2500 should return 401 if password is incorrect\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["As mentioned before, the annotation-based approach requires you to annotate literally ",(0,s.jsx)(n.strong,{children:"every test case"})," with all\nthe three labels (epic, feature and story), otherwise the report will be stubbornly displaying a flat structure in ",(0,s.jsx)(n.strong,{children:"Behaviors"})," section."]}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.p,{children:"To relax the requirement to annotate all your test cases, you can add a fallback via configuration, e.g.:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="jest.config.js"',children:"/** @type {import('@jest/types').Config.InitialOptions} */\nmodule.exports = {\n  testEnvironment: 'jest-allure2-reporter/environment-node',\n  reporters: [\n    'default',\n    [\n      'jest-allure2-reporter',\n      /** @type {import('jest-allure2-reporter').ReporterOptions} */\n      {\n        labels: {\n          epic: ({ value }) => value ?? 'Uncategorized',\n          feature: ({ value }) => value ?? 'Untitled feature',\n          story: ({ value }) => value ?? 'Untitled story',\n        },\n      },\n    ],\n  ],\n};\n"})})]}),"\n",(0,s.jsx)(n.h2,{id:"using-configuration",children:"Using configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"configuration-based approach"})," allows you to group test cases based on the available attributes like the test file path, the ancestor describe blocks and any\nother contextually available information."]}),"\n",(0,s.jsxs)(n.p,{children:["It is much faster to implement than if you were to annotate every test case by hand, but it is also less flexible.\nStill, there are many cases where it can be useful, especially if you have a large test suite and you want to add some structure to it.\nFor example, if your grouping by suite focuses mostly ",(0,s.jsx)(n.a,{href:"/jest-allure2-reporter/docs/config/grouping/by-suite#file-oriented-example",children:"on the file structure"}),',\nthe story-based grouping may add "a fresh perspective" by grouping tests by describe blocks and test names, for example.']}),"\n",(0,s.jsx)(n.p,{children:"Let's explore a simple example, where we'll map:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"epic"})," to the top-level describe block"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"feature"})," to the middle-level describe blocks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"story"})," to the lowest-level describe block"]}),"\n"]}),"\n",(0,s.jsxs)(a.A,{groupId:"configTab",children:[(0,s.jsx)(i.A,{value:"config",label:"Config",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="jest.config.js"',children:"/** @type {import('@jest/types').Config.InitialOptions} */\nmodule.exports = {\n  testEnvironment: 'jest-allure2-reporter/environment-node',\n  reporters: [\n    'default',\n    ['jest-allure2-reporter', /** @type {import('jest-allure2-reporter').ReporterOptions}*/ {\n      labels: {\n        epic: ({ testCase }) => testCase.ancestorTitles.at(0) ?? '(uncategorized)',\n        feature: ({ testCase }) => testCase.ancestorTitles.slice(1, -1).join(' > ') || '(uncategorized)',\n        story: ({ testCase }) => testCase.ancestorTitles.slice(2).at(-1) ?? '(uncategorized)',\n      },\n    }],\n  ],\n};\n"})})}),(0,s.jsx)(i.A,{value:"demo",label:"Preview",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plain",children:"\u251c\u2500 Login screen\n\u2502  \u251c\u2500 when loaded\n\u2502  \u2502  \u2514\u2500 should display login form\n\u2502  \u2514\u2500 when loaded and typed\n\u2502     \u251c\u2500 should validate e-mail\n\u2502     \u2514\u2500 should validate password\n\u251c\u2500 Forgot password screen\n\u2502  \u251c\u2500 when loaded\n\u2502  \u2502  \u2514\u2500 should display forgot password form\n\u2502  \u2514\u2500 when loaded and typed\n\u2502     \u2514\u2500 should validate e-mail\n\u251c\u2500 Login controller\n\u2502  \u251c\u2500 should return 401 if user is not found\n\u2502  \u2514\u2500 should return 401 if password is incorrect\n\u2514\u2500 Forgot password controller\n   \u251c\u2500 should return 401 if user is not found\n   \u2514\u2500 should return 401 if password is incorrect\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"many-to-many-mapping",children:"Many-to-many mapping"}),"\n",(0,s.jsx)(n.p,{children:"It is worth mentioning that Allure allows you to map a test case to multiple epics, features and stories, but\nyou should use this feature with caution, as it may lead to a very complex report structure."}),"\n",(0,s.jsxs)(a.A,{groupId:"approach",children:[(0,s.jsx)(i.A,{value:"docblock",label:"Docblocks",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="login.test.js"',children:"it('should validate e-mail', () => {\n  /**\n   * @epic Authentication\n   * @feature Login screen\n   * @story Validation\n   *\n   * @epic Security\n   * @feature XSS prevention\n   * @story Login form\n   */\n\n   // ...\n});\n"})})}),(0,s.jsx)(i.A,{value:"dsl",label:"DSL",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="login.test.js"',children:"$Epic('Authentication');\n$Feature('Login screen');\n$Story('Validation');\n$Epic('Security');\n$Feature('XSS prevention');\n$Story('Login form');\nit('should validate e-mail', () => {\n   // ...\n});\n"})})})]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},7227:(e,n,t)=>{t.d(n,{A:()=>a});t(6540);var r=t(4164);const s={tabItem:"tabItem_Ymn6"};var o=t(4848);function a({children:e,hidden:n,className:t}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,t),hidden:n,children:e})}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(6540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}},9489:(e,n,t)=>{t.d(n,{A:()=>w});var r=t(6540),s=t(4164),o=t(4245),a=t(6347),i=t(6494),l=t(2814),c=t(5167),u=t(9900);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r})))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p({value:e,tabValues:n}){return n.some((n=>n.value===e))}function g({queryString:e=!1,groupId:n}){const t=(0,a.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})}),[s,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,o=h(e),[a,l]=(0,r.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:o}))),[c,d]=g({queryString:t,groupId:s}),[f,m]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,u.Dv)(n);return[t,(0,r.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:s}),b=(()=>{const e=c??f;return p({value:e,tabValues:o})?e:null})();(0,i.A)((()=>{b&&l(b)}),[b]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)}),[d,m,o]),tabValues:o}}var m=t(1062);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=t(4848);function j({className:e,block:n,selectedValue:t,selectValue:r,tabValues:a}){const i=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),c=e=>{const n=e.currentTarget,s=i.indexOf(n),o=a[s].value;o!==t&&(l(n),r(o))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:a.map((({value:e,label:n,attributes:r})=>(0,y.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{i.push(e)},onKeyDown:u,onClick:c,...r,className:(0,s.A)("tabs__item",b.tabItem,r?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function v({lazy:e,children:n,selectedValue:t}){const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=o.find((e=>e.props.value===t));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function x(e){const n=f(e);return(0,y.jsxs)("div",{className:(0,s.A)("tabs-container",b.tabList),children:[(0,y.jsx)(j,{...n,...e}),(0,y.jsx)(v,{...n,...e})]})}function w(e){const n=(0,m.A)();return(0,y.jsx)(x,{...e,children:d(e.children)},String(n))}},9810:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/config-01-grouping-05-2d8678d4207735094d62ec7c915114c1.jpg"}}]);